## Cypress测试入门    

#### 官网简介    

1 概述    

> Cypress是为现代web构建的下一代前端测试工具。这使您能够编写更快、更容易和更可靠的测试。    
> 我们的用户通常是使用现代JavaScript框架构建web应用程序的开发人员或QA工程师。Cypress使您可以编写所有类型的测试:    
> 端到端测试 集成测试 单元测试 Cypress可以测试在浏览器中运行的任何内容。    
> 不需要安装或配置服务器、驱动程序或任何其他依赖项。Cypress的运行速度与浏览器呈现内容的速度一样快。可在开发应用程序时实时观察测试的运行情况。    

2 特点    

> 其他测试框架无法做到的事情:    
> 时间旅行:Cypress在测试运行时拍摄快照。将鼠标悬停在命令日志中的命令上，查看每一步都发生了什么。    
> 可调试性:停止猜测测试失败的原因。直接从熟悉的工具(如开发人员工具)进行调试。我们可读的错误和堆栈跟踪使调试快如闪电。    
> 自动等待:永远不要在测试中添加等待或休眠。Cypress在继续下一步之前会自动等待命令和断言。不再异步地狱。    
> 间谍、存根和时钟:验证和控制功能、服务器响应或计时器的行为。    
> 网络流量控制:在不涉及服务器的情况下，轻松地控制、存根和测试边界用例。您可以根据自己的喜好设置网络流量存根。    
> 一致的结果:我们的架构不使用Selenium或WebDriver。欢迎快速、一致、可靠、无碎片的测试。    
> 屏幕截图和视频:查看失败时自动拍摄的屏幕截图，或者从CLI运行时整个测试套件的视频。    
> 跨浏览器测试:在本地运行Firefox和chrom系列浏览器(包括Edge和Electron)中的测试，最好在持续集成管道中进行。    

3 关键区别    

> 大多数测试工具(如Selenium)都是在浏览器之外运行，并通过网络执行远程命令。正好相反，Cypress在与应用程序相同的运行循环中执行。    
> Cypress的背后是一个节点服务器进程。Cypress和节点进程经常通信、同步，并代表彼此执行任务。
> 访问这两个部分(正面和背面)使我们能够实时响应应用程序的事件，同时在浏览器之外工作，完成需要更高权限的任务。    
> Cypress还通过动态读取和修改web流量在网络层进行操作。这使得Cypress不仅可以修改进出浏览器的所有内容，还可以修改可能干扰其实现浏览器自动化能力的代码。    
> Cypress最终从上到下控制整个自动化过程，这使它处于能够理解在浏览器内外发生的一切的独特位置。这意味着Cypress能够比其他任何测试工具提供更一致的结果。    
> 因为Cypress是本地安装在计算机上的，所以它还可以接入操作系统来完成自动化任务。这使得执行诸如截屏、录制视频、一般文件系统操作和网络操作等任务成为可能。    

4 本地访问    

> 因为Cypress在应用程序中操作，这意味着它可以本机访问每个对象。无论是窗口、文档、DOM元素、应用程序实例、函数、定时器、service worker还是其他任何东西，
> 您都可以在Cypress测试中访问它。没有对象序列化，没有网络协议，您可以访问所有内容。测试代码可以访问与应用程序代码相同的所有对象。    

5 新型测试    

> 对您的应用程序、网络流量和对每个主机对象的本机访问进行最终控制，可以开启一种以前从未实现过的新的测试方法。
> Cypress可以让你改变你的应用程序工作方式的任何方面，能轻易地控制它。
> 您可以像在单元测试中那样人为地创建这些状态，而不是像创建给定情况所需的状态那样缓慢而昂贵的测试。例如，你可以:    
> 存根浏览器或应用程序的功能，并强制它们在测试用例中按需要运行。    
> 公开数据存储(如在Redux中)，这样就可以通过编程直接从测试代码更改应用程序的状态。    
> 通过强制服务器发送空响应来测试像“空视图”这样的边缘情况。    
> 通过将响应状态码修改为500，测试应用程序如何响应服务器上的错误。    
> 直接修改DOM元素，比如强制显示隐藏的元素。    
> 以编程方式使用第三方插件。您可以直接从测试代码中调用方法来控制它们，而不是纠缠于复杂的UI小部件，如下拉列表、树视图或日历。    
> 在测试时，防止在执行任何应用程序代码之前加载谷歌分析。    
> 在应用程序转换到新页面或开始卸载时获得同步通知。    
> 通过向前或向后移动来控制时间，以便计时器或轮询自动启动，而不必等待测试所需的时间。    
> 添加您自己的事件监听器来响应应用程序。在Cypress中进行测试时，可以更新应用程序代码以使其表现不同。
> 你可以从Cypress中控制WebSocket消息，有条件地加载第三方脚本，或者直接在你的应用程序上调用函数。    

6 快捷方式    

> 试图努力测试应用程序的各个领域?不喜欢一个行为产生的副作用?厌倦了一遍又一遍地重复缓慢的动作?对于大多数测试用例，您可以跳过它们。    
> Cypress可以防止您被迫总是“像用户一样”生成给定情况的状态。使用Cypress，您可以以编程方式交互和控制您的应用程序。您不再需要使用UI来构建状态。    
> 这意味着您不必访问登录页面，输入用户名和密码，并等待页面加载和/或重定向每次您运行的测试。Cypress提供了使用快捷方式和通过编程登录的功能。
> 通过使用像cy.request()这样的命令，您可以直接发送HTTP请求，同时使这些请求与浏览器同步。cookie会自动发送并应用回去。
> 担心CORS?别担心，它完全被忽略了。您可以选择什么时候像用户一样进行测试，什么时候跳过缓慢和重复的部分。    

7 抗碎片    

> Cypress同步地知道并理解应用程序中发生的所有事情。它会在页面加载和卸载时得到通知。Cypress不可能在触发事件时遗漏元素。
> Cypress甚至知道一个元素的动画速度，并会等待它停止动画。此外，它会自动等待元素变得可见、启用和停止被覆盖。
> 当页面开始转换时，Cypress将暂停命令执行，直到完全加载下一个页面。您甚至可以告诉Cypress等待特定的网络请求完成。    
> Cypress在浏览器中执行绝大多数命令，因此没有网络延迟。命令的执行和驱动您的应用程序以最快的速度呈现。
> 要处理处理复杂UI的现代JavaScript框架，可以使用断言告诉Cypress应用程序的期望状态是什么。Cypress将自动等待您的应用程序达到此状态后再继续。
> 完全不必担心手动等待或重试。Cypress会自动等待元素的存在，并且永远不会向您提供已经从DOM分离出来的过时元素。    

8 可测试性    

> 您可以在运行测试时使用开发人员工具，您可以看到每个控制台消息和每个网络请求。您可以检查元素，甚至可以在规范代码或应用程序代码中使用调试器语句。
> 没有保真度损失——你可以使用所有你已经熟悉的工具。这使您能够同时进行测试和开发。    

#### 安装使用    

1 安装过程看官网就好https://docs.cypress.io/guides/getting-started/installing-cypress.html#npm-install，有video很容易，我就不CV了。
简单提两点：Node版本要求10以上；Cypress3.0版本默认全局安装，所以package.json里不会有记录。    

2 按照官网教程走，Cypress open之后可能会发现自己的浏览器选项里没有Chrome，这个问题我记录在了issue里：https://github.com/missgentle/Q-A/issues/39    

